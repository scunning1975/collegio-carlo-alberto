<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">

<style type="text/css">
@font-face {
font-family: octicons-link;
src: url(data:font/woff;charset=utf-8;base64,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) format('woff');
}
body {
-webkit-text-size-adjust: 100%;
text-size-adjust: 100%;
color: #333;
font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
font-size: 16px;
line-height: 1.6;
word-wrap: break-word;
}
a {
background-color: transparent;
}
a:active,
a:hover {
outline: 0;
}
strong {
font-weight: bold;
}
h1 {
font-size: 2em;
margin: 0.67em 0;
}
img {
border: 0;
}
hr {
box-sizing: content-box;
height: 0;
}
pre {
overflow: auto;
}
code,
kbd,
pre {
font-family: monospace, monospace;
font-size: 1em;
}
input {
color: inherit;
font: inherit;
margin: 0;
}
html input[disabled] {
cursor: default;
}
input {
line-height: normal;
}
input[type="checkbox"] {
box-sizing: border-box;
padding: 0;
}
table {
border-collapse: collapse;
border-spacing: 0;
}
td,
th {
padding: 0;
}
* {
box-sizing: border-box;
}
input {
font: 13px / 1.4 Helvetica, arial, nimbussansl, liberationsans, freesans, clean, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
}
a {
color: #4078c0;
text-decoration: none;
}
a:hover,
a:active {
text-decoration: underline;
}
hr {
height: 0;
margin: 15px 0;
overflow: hidden;
background: transparent;
border: 0;
border-bottom: 1px solid #ddd;
}
hr:before {
display: table;
content: "";
}
hr:after {
display: table;
clear: both;
content: "";
}
h1,
h2,
h3,
h4,
h5,
h6 {
margin-top: 15px;
margin-bottom: 15px;
line-height: 1.1;
}
h1 {
font-size: 30px;
}
h2 {
font-size: 21px;
}
h3 {
font-size: 16px;
}
h4 {
font-size: 14px;
}
h5 {
font-size: 12px;
}
h6 {
font-size: 11px;
}
blockquote {
margin: 0;
}
ul,
ol {
padding: 0;
margin-top: 0;
margin-bottom: 0;
}
ol ol,
ul ol {
list-style-type: lower-roman;
}
ul ul ol,
ul ol ol,
ol ul ol,
ol ol ol {
list-style-type: lower-alpha;
}
dd {
margin-left: 0;
}
code {
font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
font-size: 12px;
}
pre {
margin-top: 0;
margin-bottom: 0;
font: 12px Consolas, "Liberation Mono", Menlo, Courier, monospace;
}
.select::-ms-expand {
opacity: 0;
}
.octicon {
font: normal normal normal 16px/1 octicons-link;
display: inline-block;
text-decoration: none;
text-rendering: auto;
-webkit-font-smoothing: antialiased;
-moz-osx-font-smoothing: grayscale;
-webkit-user-select: none;
-moz-user-select: none;
-ms-user-select: none;
user-select: none;
}
.octicon-link:before {
content: '\f05c';
}
.markdown-body:before {
display: table;
content: "";
}
.markdown-body:after {
display: table;
clear: both;
content: "";
}
.markdown-body>*:first-child {
margin-top: 0 !important;
}
.markdown-body>*:last-child {
margin-bottom: 0 !important;
}
a:not([href]) {
color: inherit;
text-decoration: none;
}
.anchor {
display: inline-block;
padding-right: 2px;
margin-left: -18px;
}
.anchor:focus {
outline: none;
}
h1,
h2,
h3,
h4,
h5,
h6 {
margin-top: 1em;
margin-bottom: 16px;
font-weight: bold;
line-height: 1.4;
}
h1 .octicon-link,
h2 .octicon-link,
h3 .octicon-link,
h4 .octicon-link,
h5 .octicon-link,
h6 .octicon-link {
color: #000;
vertical-align: middle;
visibility: hidden;
}
h1:hover .anchor,
h2:hover .anchor,
h3:hover .anchor,
h4:hover .anchor,
h5:hover .anchor,
h6:hover .anchor {
text-decoration: none;
}
h1:hover .anchor .octicon-link,
h2:hover .anchor .octicon-link,
h3:hover .anchor .octicon-link,
h4:hover .anchor .octicon-link,
h5:hover .anchor .octicon-link,
h6:hover .anchor .octicon-link {
visibility: visible;
}
h1 {
padding-bottom: 0.3em;
font-size: 2.25em;
line-height: 1.2;
border-bottom: 1px solid #eee;
}
h1 .anchor {
line-height: 1;
}
h2 {
padding-bottom: 0.3em;
font-size: 1.75em;
line-height: 1.225;
border-bottom: 1px solid #eee;
}
h2 .anchor {
line-height: 1;
}
h3 {
font-size: 1.5em;
line-height: 1.43;
}
h3 .anchor {
line-height: 1.2;
}
h4 {
font-size: 1.25em;
}
h4 .anchor {
line-height: 1.2;
}
h5 {
font-size: 1em;
}
h5 .anchor {
line-height: 1.1;
}
h6 {
font-size: 1em;
color: #777;
}
h6 .anchor {
line-height: 1.1;
}
p,
blockquote,
ul,
ol,
dl,
table,
pre {
margin-top: 0;
margin-bottom: 16px;
}
hr {
height: 4px;
padding: 0;
margin: 16px 0;
background-color: #e7e7e7;
border: 0 none;
}
ul,
ol {
padding-left: 2em;
}
ul ul,
ul ol,
ol ol,
ol ul {
margin-top: 0;
margin-bottom: 0;
}
li>p {
margin-top: 16px;
}
dl {
padding: 0;
}
dl dt {
padding: 0;
margin-top: 16px;
font-size: 1em;
font-style: italic;
font-weight: bold;
}
dl dd {
padding: 0 16px;
margin-bottom: 16px;
}
blockquote {
padding: 0 15px;
color: #777;
border-left: 4px solid #ddd;
}
blockquote>:first-child {
margin-top: 0;
}
blockquote>:last-child {
margin-bottom: 0;
}
table {
display: block;
width: 100%;
overflow: auto;
word-break: normal;
word-break: keep-all;
}
table th {
font-weight: bold;
}
table th,
table td {
padding: 6px 13px;
border: 1px solid #ddd;
}
table tr {
background-color: #fff;
border-top: 1px solid #ccc;
}
table tr:nth-child(2n) {
background-color: #f8f8f8;
}
img {
max-width: 100%;
box-sizing: content-box;
background-color: #fff;
}
code {
padding: 0;
padding-top: 0.2em;
padding-bottom: 0.2em;
margin: 0;
font-size: 85%;
background-color: rgba(0,0,0,0.04);
border-radius: 3px;
}
code:before,
code:after {
letter-spacing: -0.2em;
content: "\00a0";
}
pre>code {
padding: 0;
margin: 0;
font-size: 100%;
word-break: normal;
white-space: pre;
background: transparent;
border: 0;
}
.highlight {
margin-bottom: 16px;
}
.highlight pre,
pre {
padding: 16px;
overflow: auto;
font-size: 85%;
line-height: 1.45;
background-color: #f7f7f7;
border-radius: 3px;
}
.highlight pre {
margin-bottom: 0;
word-break: normal;
}
pre {
word-wrap: normal;
}
pre code {
display: inline;
max-width: initial;
padding: 0;
margin: 0;
overflow: initial;
line-height: inherit;
word-wrap: normal;
background-color: transparent;
border: 0;
}
pre code:before,
pre code:after {
content: normal;
}
kbd {
display: inline-block;
padding: 3px 5px;
font-size: 11px;
line-height: 10px;
color: #555;
vertical-align: middle;
background-color: #fcfcfc;
border: solid 1px #ccc;
border-bottom-color: #bbb;
border-radius: 3px;
box-shadow: inset 0 -1px 0 #bbb;
}
.pl-c {
color: #969896;
}
.pl-c1,
.pl-s .pl-v {
color: #0086b3;
}
.pl-e,
.pl-en {
color: #795da3;
}
.pl-s .pl-s1,
.pl-smi {
color: #333;
}
.pl-ent {
color: #63a35c;
}
.pl-k {
color: #a71d5d;
}
.pl-pds,
.pl-s,
.pl-s .pl-pse .pl-s1,
.pl-sr,
.pl-sr .pl-cce,
.pl-sr .pl-sra,
.pl-sr .pl-sre {
color: #183691;
}
.pl-v {
color: #ed6a43;
}
.pl-id {
color: #b52a1d;
}
.pl-ii {
background-color: #b52a1d;
color: #f8f8f8;
}
.pl-sr .pl-cce {
color: #63a35c;
font-weight: bold;
}
.pl-ml {
color: #693a17;
}
.pl-mh,
.pl-mh .pl-en,
.pl-ms {
color: #1d3e81;
font-weight: bold;
}
.pl-mq {
color: #008080;
}
.pl-mi {
color: #333;
font-style: italic;
}
.pl-mb {
color: #333;
font-weight: bold;
}
.pl-md {
background-color: #ffecec;
color: #bd2c00;
}
.pl-mi1 {
background-color: #eaffea;
color: #55a532;
}
.pl-mdr {
color: #795da3;
font-weight: bold;
}
.pl-mo {
color: #1d3e81;
}
kbd {
display: inline-block;
padding: 3px 5px;
font: 11px Consolas, "Liberation Mono", Menlo, Courier, monospace;
line-height: 10px;
color: #555;
vertical-align: middle;
background-color: #fcfcfc;
border: solid 1px #ccc;
border-bottom-color: #bbb;
border-radius: 3px;
box-shadow: inset 0 -1px 0 #bbb;
}
.task-list-item {
list-style-type: none;
}
.task-list-item+.task-list-item {
margin-top: 3px;
}
.task-list-item input {
margin: 0 0.35em 0.25em -1.6em;
vertical-align: middle;
}
:checked+.radio-label {
z-index: 1;
position: relative;
border-color: #4078c0;
}
.sourceLine {
display: inline-block;
}
code .kw { color: #000000; }
code .dt { color: #ed6a43; }
code .dv { color: #009999; }
code .bn { color: #009999; }
code .fl { color: #009999; }
code .ch { color: #009999; }
code .st { color: #183691; }
code .co { color: #969896; }
code .ot { color: #0086b3; }
code .al { color: #a61717; }
code .fu { color: #63a35c; }
code .er { color: #a61717; background-color: #e3d2d2; }
code .wa { color: #000000; }
code .cn { color: #008080; }
code .sc { color: #008080; }
code .vs { color: #183691; }
code .ss { color: #183691; }
code .im { color: #000000; }
code .va {color: #008080; }
code .cf { color: #000000; }
code .op { color: #000000; }
code .bu { color: #000000; }
code .ex { color: #000000; }
code .pp { color: #999999; }
code .at { color: #008080; }
code .do { color: #969896; }
code .an { color: #008080; }
code .cv { color: #008080; }
code .in { color: #008080; }
</style>
<style>
body {
  box-sizing: border-box;
  min-width: 200px;
  max-width: 980px;
  margin: 0 auto;
  padding: 45px;
  padding-top: 0px;
}
</style>


</head>

<body>

<h1 id="lalonde">Lalonde</h1>
<p>The National Supported Work (NSW) Demonstration dataset is one of the
most commonly used dataset in econometrics based on <a href="https://business.baylor.edu/scott_cunningham/teaching/lalonde-1986.pdf">Lalonde
(1986)</a> and <a href="https://business.baylor.edu/scott_cunningham/teaching/dehejia-and-wahba-2002.pdf">Dehejia
and Wahba (2002)</a>. Both the original 1986 article by Lalonde as well
as the follow-up articles by Dehejia and Wahba used the data to evaluate
contemporary approaches to causal inference using non-experimental data.
Cleverly, they start with an experimental dataset to establish ‘true’
causal effect and then use a non-experimental dataset consisting of a
control group of randomly sampled American households to see if
covariate adjustment can recover causal effects under fairly dramatic
selection problems.</p>
<p>In <a href="github.com/Mixtape-Sessions/Causal-Inference-1">Causal
Inference 1</a>, we have already shown that the nonexperimental dataset
suffers from severe negative selection into the job trainings program.
Simple comparisons often found negative effects of job training on
earnings despite the fact the program had an average positive effect of
around $1700 higher real earnings in 1978. That lab found that some
selection on observable methods like propensity score weighting and
nearest neighbor matching recovered causal effects close to that found
using experimental data.</p>
<p>In this lab, we will study the performance of several
difference-in-differences estimators using both the experimental and
non-experimental datasets.</p>
<ol style="list-style-type: decimal">
<li>We will first perform analysis on the experimental dataset
<code>https://raw.github.com/Mixtape-Sessions/Causal-Inference-2/master/Labs/Lalonde/lalonde_exp_panel.dta</code></li>
</ol>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fixest)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DRDID) <span class="co"># devtools::install_github(&quot;pedrohcgs/DRDID&quot;)</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Experimental data</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>df_exp <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">read_dta</span>(<span class="st">&quot;https://raw.github.com/Mixtape-Sessions/Causal-Inference-2/master/Lab/Lalonde/lalonde_exp_panel.dta&quot;</span>)</span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Under random assignment, the simple difference-in-means identifies
the ATE, and since the original NSW was a randomized experiment, we can
do this. Calculate the simple difference-in-means on the experimental
dataset to estimate the “treatment effect” two separate ways: (1)
manually calculate averages for both treatment
(<code>ever_treated=1</code>) and control (<code>ever_treated=0</code>)
and use them to estimate the returns to the program, and (2) estimate
the effect with an OLS specification. In both cases, use only the year
<code>78</code> and <code>re</code> variable for real earnings.</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Difference-in-means - Averages</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(df_exp, {</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  y11 <span class="ot">=</span> <span class="fu">mean</span>(re[year <span class="sc">==</span> <span class="dv">78</span> <span class="sc">&amp;</span> ever_treated <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  y01 <span class="ot">=</span> <span class="fu">mean</span>(re[year <span class="sc">==</span> <span class="dv">78</span> <span class="sc">&amp;</span> ever_treated <span class="sc">==</span> <span class="dv">0</span>])</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  dim <span class="ot">=</span> y11 <span class="sc">-</span> y01</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  dim</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>[1] 1794.342</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Difference-in-means - OLS</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">feols</span>(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  re <span class="sc">~</span> <span class="fu">i</span>(treat),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_exp <span class="sc">|&gt;</span> <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">78</span>), <span class="at">vcov =</span> <span class="st">&quot;hc1&quot;</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>OLS estimation, Dep. Var.: re
Observations: 445 
Standard-errors: Heteroskedasticity-robust 
            Estimate Std. Error  t value  Pr(&gt;|t|)    
(Intercept)  4554.80    340.204 13.38845 &lt; 2.2e-16 ***
treat::1     1794.34    670.824  2.67483 0.0077534 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
RMSE: 6,564.7   Adj. R2: 0.015606</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Estimate the effect of the treatment, <code>ever_treated</code>, on
real earnings, <code>re</code>, in a difference-in-differences estimator
using years <code>78</code> for post period and <code>75</code> as the
pre-period (ignoring for now year <code>74</code>). As with 1a, do this
in the following two ways: (1) manually calculate the four means you
need for the DiD equation and then estimate using the DiD equation, and
(2) estimate the ATT using the OLS specification for the DiD equation
with robust standard errors. Reminder to only use <code>78</code> and
<code>75</code> (i.e., do not include <code>74</code> in OLS
analysis).</li>
</ol>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Difference-in-Differences - Averages</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(df_exp, {</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  y00 <span class="ot">=</span> <span class="fu">mean</span>(re[year <span class="sc">==</span> <span class="dv">75</span> <span class="sc">&amp;</span> ever_treated <span class="sc">==</span> <span class="dv">0</span>])</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  y01 <span class="ot">=</span> <span class="fu">mean</span>(re[year <span class="sc">==</span> <span class="dv">78</span> <span class="sc">&amp;</span> ever_treated <span class="sc">==</span> <span class="dv">0</span>])</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  y10 <span class="ot">=</span> <span class="fu">mean</span>(re[year <span class="sc">==</span> <span class="dv">75</span> <span class="sc">&amp;</span> ever_treated <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  y11 <span class="ot">=</span> <span class="fu">mean</span>(re[year <span class="sc">==</span> <span class="dv">78</span> <span class="sc">&amp;</span> ever_treated <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  did <span class="ot">=</span> (y11 <span class="sc">-</span> y10) <span class="sc">-</span> (y01 <span class="sc">-</span> y00)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  did</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>[1] 1529.196</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Difference-in-Differences - OLS</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">feols</span>(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  re <span class="sc">~</span> <span class="fu">i</span>(treat) <span class="sc">|</span> id <span class="sc">+</span> year, </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_exp <span class="sc">|&gt;</span> <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">75</span>, <span class="dv">78</span>)), </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">vcov =</span> <span class="st">&quot;hc1&quot;</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>OLS estimation, Dep. Var.: re
Observations: 890 
Fixed-effects: id: 445,  year: 2
Standard-errors: Heteroskedasticity-robust 
         Estimate Std. Error t value Pr(&gt;|t|)    
treat::1   1529.2    714.956 2.13887 0.032992 *  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
RMSE: 3,524.5     Adj. R2: 0.189077
                Within R2: 0.011302</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Check the pre-trends for 1974 relative to 1975 two ways: (1)
manually calculate the DiD equation on 1974 relative to 1975 and (2)
estimate the dynamic OLS specification with an interaction of
<code>ever_treated</code> with <code>74</code>, an interaction of
<code>ever_treated</code> with <code>78</code>. Compare your answers for
2c to what you found in 2a and 2b.</li>
</ol>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Event study and pre-trends using manually calculated averages</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(df_exp, {</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  y00 <span class="ot">=</span> <span class="fu">mean</span>(re[year <span class="sc">==</span> <span class="dv">75</span> <span class="sc">&amp;</span> ever_treated <span class="sc">==</span> <span class="dv">0</span>])</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  y01 <span class="ot">=</span> <span class="fu">mean</span>(re[year <span class="sc">==</span> <span class="dv">74</span> <span class="sc">&amp;</span> ever_treated <span class="sc">==</span> <span class="dv">0</span>])</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  y10 <span class="ot">=</span> <span class="fu">mean</span>(re[year <span class="sc">==</span> <span class="dv">75</span> <span class="sc">&amp;</span> ever_treated <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  y11 <span class="ot">=</span> <span class="fu">mean</span>(re[year <span class="sc">==</span> <span class="dv">74</span> <span class="sc">&amp;</span> ever_treated <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  did <span class="ot">=</span> (y11 <span class="sc">-</span> y10) <span class="sc">-</span> (y01 <span class="sc">-</span> y00)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  did</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>[1] -276.5993</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Event study and pre-trends using OLS </span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>df_exp<span class="sc">$</span>pre <span class="ot">=</span> df_exp<span class="sc">$</span>ever_treated <span class="sc">*</span> (df_exp<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">74</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>df_exp<span class="sc">$</span>post <span class="ot">=</span> df_exp<span class="sc">$</span>ever_treated <span class="sc">*</span> (df_exp<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">78</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="fu">feols</span>(</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  re <span class="sc">~</span> <span class="fu">i</span>(post) <span class="sc">+</span> <span class="fu">i</span>(pre) <span class="sc">|</span> id <span class="sc">+</span> year, </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_exp, </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">vcov =</span> <span class="st">&quot;hc1&quot;</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>OLS estimation, Dep. Var.: re
Observations: 1,335 
Fixed-effects: id: 445,  year: 3
Standard-errors: Heteroskedasticity-robust 
        Estimate Std. Error   t value Pr(&gt;|t|)    
post::1 1529.196    687.872  2.223082 0.026462 *  
pre::1  -276.599    539.640 -0.512562 0.608385    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
RMSE: 3,828.4     Adj. R2: 0.274114
                Within R2: 0.010343</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Now, we turn to the non-experimental dataset
<code>https://raw.github.com/Mixtape-Sessions/Causal-Inference-2/master/Labs/Lalonde/lalonde_nonexp_panel.dta</code>.</li>
</ol>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. CPS data</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>df_nonexp <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">read_dta</span>(<span class="st">&quot;https://raw.github.com/Mixtape-Sessions/Causal-Inference-2/master/Lab/Lalonde/lalonde_nonexp_panel.dta&quot;</span>)</span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Repeat 1a (simple difference-in-means for <code>78</code> only), 1b
(DiD using manual calculations and OLS specification for <code>78</code>
and <code>75</code> only) and 1c (event study calculations manually and
dynamic OLS specification for <code>78</code>, <code>75</code> and
<code>74</code>)</li>
</ol>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Difference-in-means - Averages</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(df_nonexp, {</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(re[year <span class="sc">==</span> <span class="dv">78</span> <span class="sc">&amp;</span> ever_treated <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(re[year <span class="sc">==</span> <span class="dv">78</span> <span class="sc">&amp;</span> ever_treated <span class="sc">==</span> <span class="dv">0</span>])</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>[1] -8497.516</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Difference-in-means - OLS</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">feols</span>(</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  re <span class="sc">~</span> <span class="fu">i</span>(treat),</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_exp <span class="sc">|&gt;</span> <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">78</span>), <span class="at">vcov =</span> <span class="st">&quot;hc1&quot;</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>OLS estimation, Dep. Var.: re
Observations: 445 
Standard-errors: Heteroskedasticity-robust 
            Estimate Std. Error  t value  Pr(&gt;|t|)    
(Intercept)  4554.80    340.204 13.38845 &lt; 2.2e-16 ***
treat::1     1794.34    670.824  2.67483 0.0077534 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
RMSE: 6,564.7   Adj. R2: 0.015606</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Difference-in-Differences - Averages</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(df_nonexp, {</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  y00 <span class="ot">=</span> <span class="fu">mean</span>(re[year <span class="sc">==</span> <span class="dv">75</span> <span class="sc">&amp;</span> ever_treated <span class="sc">==</span> <span class="dv">0</span>])</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  y01 <span class="ot">=</span> <span class="fu">mean</span>(re[year <span class="sc">==</span> <span class="dv">78</span> <span class="sc">&amp;</span> ever_treated <span class="sc">==</span> <span class="dv">0</span>])</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  y10 <span class="ot">=</span> <span class="fu">mean</span>(re[year <span class="sc">==</span> <span class="dv">75</span> <span class="sc">&amp;</span> ever_treated <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  y11 <span class="ot">=</span> <span class="fu">mean</span>(re[year <span class="sc">==</span> <span class="dv">78</span> <span class="sc">&amp;</span> ever_treated <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  did <span class="ot">=</span> (y11 <span class="sc">-</span> y10) <span class="sc">-</span> (y01 <span class="sc">-</span> y00)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  did</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>[1] 3621.232</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Difference-in-Differences - OLS</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">feols</span>(</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  re <span class="sc">~</span> <span class="fu">i</span>(treat) <span class="sc">|</span> id <span class="sc">+</span> year, </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_nonexp <span class="sc">|&gt;</span> <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">75</span>, <span class="dv">78</span>)),</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">vcov =</span> <span class="st">&quot;hc1&quot;</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>OLS estimation, Dep. Var.: re
Observations: 32,354 
Fixed-effects: id: 16,177,  year: 2
Standard-errors: Heteroskedasticity-robust 
         Estimate Std. Error t value   Pr(&gt;|t|)    
treat::1  3621.23    609.868 5.93773 2.9491e-09 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
RMSE: 3,858.1     Adj. R2: 0.670904
                Within R2: 0.002483</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Event study and pre-trends using manually calculated averages</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(df_nonexp, {</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  y00 <span class="ot">=</span> <span class="fu">mean</span>(re[year <span class="sc">==</span> <span class="dv">75</span> <span class="sc">&amp;</span> ever_treated <span class="sc">==</span> <span class="dv">0</span>])</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  y01 <span class="ot">=</span> <span class="fu">mean</span>(re[year <span class="sc">==</span> <span class="dv">74</span> <span class="sc">&amp;</span> ever_treated <span class="sc">==</span> <span class="dv">0</span>])</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  y10 <span class="ot">=</span> <span class="fu">mean</span>(re[year <span class="sc">==</span> <span class="dv">75</span> <span class="sc">&amp;</span> ever_treated <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  y11 <span class="ot">=</span> <span class="fu">mean</span>(re[year <span class="sc">==</span> <span class="dv">74</span> <span class="sc">&amp;</span> ever_treated <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  did <span class="ot">=</span> (y11 <span class="sc">-</span> y10) <span class="sc">-</span> (y01 <span class="sc">-</span> y00)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  did</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>[1] 197.5215</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Event study and pre-trends using OLS </span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>df_nonexp<span class="sc">$</span>pre <span class="ot">=</span> df_nonexp<span class="sc">$</span>ever_treated <span class="sc">*</span> (df_nonexp<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">74</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>df_nonexp<span class="sc">$</span>post <span class="ot">=</span> df_nonexp<span class="sc">$</span>ever_treated <span class="sc">*</span> (df_nonexp<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">78</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="fu">feols</span>(</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  re <span class="sc">~</span> <span class="fu">i</span>(post) <span class="sc">+</span> <span class="fu">i</span>(pre) <span class="sc">|</span> id <span class="sc">+</span> year, </span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_nonexp, </span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">vcov =</span> <span class="st">&quot;hc1&quot;</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>OLS estimation, Dep. Var.: re
Observations: 48,531 
Fixed-effects: id: 16,177,  year: 3
Standard-errors: Heteroskedasticity-robust 
        Estimate Std. Error  t value   Pr(&gt;|t|)    
post::1 3621.232    577.183 6.273972 3.5640e-10 ***
pre::1   197.522    431.728 0.457513 6.4731e-01    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
RMSE: 4,073.4     Adj. R2: 0.72694
                Within R2: 0.00188</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Repeat 1b and 1c (OLS specifications) controlling linearly for
<code>age, agesq, agecube, educ, educsq, marr, nodegree, black, hisp</code>
with robust standard errors.</li>
</ol>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Difference-in-differeces - OLS with covariates </span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"># age, agesq, agecube, educ, educsq, marr, nodegree, black, hisp</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">feols</span>(re <span class="sc">~</span> <span class="fu">i</span>(post) <span class="sc">+</span> age <span class="sc">+</span> agesq <span class="sc">+</span> agecube <span class="sc">+</span> educ <span class="sc">+</span> educsq <span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  marr <span class="sc">+</span> nodegree <span class="sc">+</span> black <span class="sc">+</span> hisp <span class="sc">|</span> ever_treated <span class="sc">+</span> year, </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> df_nonexp,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>   <span class="at">vcov =</span> <span class="st">&quot;hc1&quot;</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>OLS estimation, Dep. Var.: re
Observations: 48,531 
Fixed-effects: ever_treated: 2,  year: 3
Standard-errors: Heteroskedasticity-robust 
             Estimate Std. Error   t value   Pr(&gt;|t|)    
post::1   3522.471290 664.595928   5.30017 1.1620e-07 ***
age       3064.963427 122.595591  25.00060  &lt; 2.2e-16 ***
agesq      -66.596546   3.679051 -18.10156  &lt; 2.2e-16 ***
agecube      0.463888   0.034921  13.28381  &lt; 2.2e-16 ***
educ       914.147339  66.589112  13.72818  &lt; 2.2e-16 ***
educsq     -33.970475   2.800199 -12.13145  &lt; 2.2e-16 ***
marr      3329.034931 105.472209  31.56315  &lt; 2.2e-16 ***
nodegree -1001.024881 122.001842  -8.20500 2.3620e-16 ***
black    -2159.036745 143.815162 -15.01258  &lt; 2.2e-16 ***
hisp      -962.553918 146.958309  -6.54984 5.8171e-11 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
RMSE: 8,374.6     Adj. R2: 0.230409
                Within R2: 0.216879</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Use the <code>DRDID</code> command to estimate a doubly-robust
difference-in-differences with covariates
<code>age + agesq + agecube + educ + educsq + marr + nodegree + black + hisp</code>,
<code>id</code> panel unit identifier, <code>year</code> as the panel
time identifier, and reporting the outcome regression analysis <a href="http://jenni.uchicago.edu/papers/Heckman_Ichimura-Todd_REStud_v64-4_1997.pdf">(Heckman,
Ichimura and Todd 1997)</a>, inverse probability weight estimator <a href="https://academic.oup.com/restud/article-abstract/72/1/1/1581053?redirectedFrom=fulltext">(Abadie
2005)</a>, doubly robust <a href="https://www.sciencedirect.com/science/article/abs/pii/S0304407620301901">(Sant’anna
and Zhao 2020)</a>. Compare these results with 1a, 1b, 2a and 2b.</li>
</ol>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Double-robust DID</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>DRDID<span class="sc">::</span><span class="fu">drdid</span>(</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">yname =</span> <span class="st">&quot;re&quot;</span>, <span class="at">tname =</span> <span class="st">&quot;year&quot;</span>, <span class="at">idname =</span> <span class="st">&quot;id&quot;</span>, <span class="at">dname =</span> <span class="st">&quot;ever_treated&quot;</span>, </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">xformla =</span> <span class="sc">~</span> age <span class="sc">+</span> agesq <span class="sc">+</span> agecube <span class="sc">+</span> educ <span class="sc">+</span> educsq <span class="sc">+</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    marr <span class="sc">+</span> nodegree <span class="sc">+</span> black <span class="sc">+</span> hisp <span class="sc">+</span> re74 <span class="sc">+</span> u74,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_nonexp <span class="sc">|&gt;</span> <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">75</span> <span class="sc">|</span> year <span class="sc">==</span> <span class="dv">78</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code> Call:
DRDID::drdid(yname = &quot;re&quot;, tname = &quot;year&quot;, idname = &quot;id&quot;, dname = &quot;ever_treated&quot;, 
    xformla = ~age + agesq + agecube + educ + educsq + marr + 
        nodegree + black + hisp + re74 + u74, data = filter(df_nonexp, 
        year == 75 | year == 78))
------------------------------------------------------------------
 Further improved locally efficient DR DID estimator for the ATT:
 
   ATT     Std. Error  t value    Pr(&gt;|t|)  [95% Conf. Interval] 
2032.9217   707.4779    2.8735     0.0041    646.265   3419.5784 
------------------------------------------------------------------
 Estimator based on panel data.
 Outcome regression est. method: weighted least squares.
 Propensity score est. method: inverse prob. tilting.
 Analytical standard error.
------------------------------------------------------------------
 See Sant&#39;Anna and Zhao (2020) for details.</code></pre>

</body>
</html>
